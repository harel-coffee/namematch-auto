

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>namematch package &mdash; namematch 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="index.html">
                namematch
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="index.html">Docs</a></li>
        
      <li>namematch package</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="_sources/namematch.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Name Match</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-name-match-doing">What is Name Match doing?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#inputs-and-outputs">Inputs and outputs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="match_setup.html">Setting Up a Match</a><ul>
<li class="toctree-l2"><a class="reference internal" href="match_setup.html#preparing-the-data-for-name-match">Preparing the data for Name Match</a></li>
<li class="toctree-l2"><a class="reference internal" href="match_setup.html#creating-the-configuration-file">Creating the configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="match_setup.html#creating-user-defined-clustering-functions">Creating user defined clustering functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="match_setup.html#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="match_setup.html#special-cases">Special cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="understanding_results.html">Understanding Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="algorithm.html#why-is-name-match-necessary">Why is Name Match necessary</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithm.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithm.html#things-to-consider">Things to consider</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.process_config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.process_config</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.process_input_data"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.process_input_data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.generate_must_links"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.generate_must_links</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.block"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.block</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.generate_data_rows"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.generate_data_rows</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.fit_model"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.fit_model</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.predict"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.predict</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.cluster"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.cluster</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-namematch.generate_output"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namematch.generate_output</span></code></a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <div class="section" id="namematch-package">
<h1>namematch package<a class="headerlink" href="#namematch-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="namematch.data_structures.html">namematch.data_structures package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="namematch.data_structures.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.data_structures.html#module-namematch.data_structures.data_file">namematch.data_structures.data_file module</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.data_structures.html#module-namematch.data_structures.parameters">namematch.data_structures.parameters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.data_structures.html#module-namematch.data_structures.schema">namematch.data_structures.schema module</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.data_structures.html#module-namematch.data_structures.variable">namematch.data_structures.variable module</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.data_structures.html#module-namematch.data_structures">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="namematch.utils.html">namematch.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="namematch.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.utils.html#module-namematch.utils.utils">namematch.utils.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="namematch.utils.html#module-namematch.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-namematch.base">
<span id="namematch-base-module"></span><h2>namematch.base module<a class="headerlink" href="#module-namematch.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.base.NamematchBase">
<em class="property">class </em><code class="sig-prename descclassname">namematch.base.</code><code class="sig-name descname">NamematchBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span><span class="p">:</span> <span class="n"><a class="reference internal" href="namematch.data_structures.html#namematch.data_structures.parameters.Parameters" title="namematch.data_structures.parameters.Parameters">namematch.data_structures.parameters.Parameters</a></span></em>, <em class="sig-param"><span class="n">schema</span><span class="p">:</span> <span class="n"><a class="reference internal" href="namematch.data_structures.html#namematch.data_structures.schema.Schema" title="namematch.data_structures.schema.Schema">namematch.data_structures.schema.Schema</a></span></em>, <em class="sig-param"><span class="n">output_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/base.html#NamematchBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.base.NamematchBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>The base class for namematch steps</p>
<p>All the inherited classes should have other input/output file paths for each step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>object</em>) – namematch’s Parameter object</p></li>
<li><p><strong>schema</strong> (<em>object</em>) – namematch’s Schema object</p></li>
<li><p><strong>logger_id</strong> (<em>str</em>) – logging for using specific logger</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – output file path</p></li>
<li><p><strong>logger</strong> (<em>object</em>) – logging.logger object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="namematch.base.NamematchBase.logger_init">
<code class="sig-name descname">logger_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logging_params</span></em>, <em class="sig-param"><span class="n">log_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/base.html#NamematchBase.logger_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.base.NamematchBase.logger_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.base.NamematchBase.output_exists">
<em class="property">property </em><code class="sig-name descname">output_exists</code><a class="headerlink" href="#namematch.base.NamematchBase.output_exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.base.NamematchBase.release_log_handlers">
<code class="sig-name descname">release_log_handlers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/base.html#NamematchBase.release_log_handlers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.base.NamematchBase.release_log_handlers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.base.NamematchBase.remove_output">
<code class="sig-name descname">remove_output</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/base.html#NamematchBase.remove_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.base.NamematchBase.remove_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.block">
<span id="namematch-block-module"></span><h2>namematch.block module<a class="headerlink" href="#module-namematch.block" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.block.Block">
<em class="property">class </em><code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">Block</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">schema</span></em>, <em class="sig-param"><span class="n">all_names_file</span></em>, <em class="sig-param"><span class="n">must_links_file</span></em>, <em class="sig-param"><span class="n">og_blocking_index_file</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">'output_temp/candidate_pairs.parquet'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#Block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.Block" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.block.Block.compute_cosine_sim">
<code class="sig-name descname">compute_cosine_sim</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.compute_cosine_sim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.convert_all_names_to_blockstring_info">
<code class="sig-name descname">convert_all_names_to_blockstring_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.convert_all_names_to_blockstring_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.evaluate_blocking">
<code class="sig-name descname">evaluate_blocking</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.evaluate_blocking" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.generate_candidate_pairs">
<code class="sig-name descname">generate_candidate_pairs</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.generate_candidate_pairs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.generate_index">
<code class="sig-name descname">generate_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.generate_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.generate_shingles_matrix">
<code class="sig-name descname">generate_shingles_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.generate_shingles_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.get_indices">
<code class="sig-name descname">get_indices</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.get_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.get_query_strings">
<code class="sig-name descname">get_query_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nn_string_info</span></em>, <em class="sig-param"><span class="n">blocking_scheme</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#Block.get_query_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.Block.get_query_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter to nn_strings that appear in the new data – these are the only strings
for which we need near-neighbors. If incremental is False, this filtering step does nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nn_string_info</strong> (<em>pd.DataFrame</em>) – <p>table with one row per nn_string (or expanded nn_string)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>nn_string</p></td>
<td><p>concatenated version of nn-blocking columns (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>commonness_penalty</p></td>
<td><p>float indicating how common the last name is</p></td>
</tr>
<tr class="row-odd"><td><p>n_new</p></td>
<td><p>number of times this nn_string appears in a “new” record</p></td>
</tr>
<tr class="row-even"><td><p>n_existing</p></td>
<td><p>number of times this nn_string appears in an “existing” record</p></td>
</tr>
<tr class="row-odd"><td><p>n_total</p></td>
<td><p>number of times this nn_string appears in any record</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>blocking_scheme</strong> (<em>dict</em>) – dictionary with info on how to do blocking</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nn_string_info, subset to nn_strings where n_new &gt; -
list: nn_strings that appear at least once in a “new” record
csr_matrix: sparse weighted shingles matrix for the nn_strings that appear in a new record</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.load_main_index">
<code class="sig-name descname">load_main_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.load_main_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.main__block">
<code class="sig-name descname">main__block</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.main__block" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.block.Block.split_last_names">
<code class="sig-name descname">split_last_names</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.block.Block.split_last_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="namematch.block.add_uncovered_pairs">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">add_uncovered_pairs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">candidate_pairs_df</span></em>, <em class="sig-param"><span class="n">uncovered_pairs_df</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#add_uncovered_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.add_uncovered_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the uncovered pairs to the candidate pairs dataframe so that all of the
known pairs are in the candidate pairs list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate_pairs_df</strong> (<em>pd.DataFrame</em>) – candidate pairs file produced by blocking</p></li>
<li><p><strong>uncovered_pairs_df</strong> (<em>pd.DataFrame</em>) – uncovered pairs produced by evaluating blocking</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>candidate-pairs file</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>blockstring_1</p></td>
<td><p>concatenated version of blocking columns for first element in pair (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>blockstring_2</p></td>
<td><p>concatenated version of blocking columns for second element in pair (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>cos_dist</p></td>
<td><p>approximate cosine distance between two nn_strings (nmslib)</p></td>
</tr>
<tr class="row-even"><td><p>edit_dist</p></td>
<td><p>number of character edits between ed-strings</p></td>
</tr>
<tr class="row-odd"><td><p>covered_pair</p></td>
<td><p>flag; 1 for pairs that made it through blocking, 0 otherwise</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.apply_blocking_filter">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">apply_blocking_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#apply_blocking_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.apply_blocking_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare similarity of names and DOBs to see if a pair of records are likely to be a match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – <p>holds similarity and commonness info about pairs of names</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>nn_string_1</p></td>
<td><p>concatenated version of nn-blocking columns for first element in pair (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>nn_string_2</p></td>
<td><p>concatenated version of nn-blocking columns for second element in pair (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>cos_dist</p></td>
<td><p>approximate cosine distance between two nn_strings (nmslib)</p></td>
</tr>
<tr class="row-even"><td><p>commonness_penalty_1</p></td>
<td><p>penalty for last-name commonness for first element in pair</p></td>
</tr>
<tr class="row-odd"><td><p>commonness_penalty_2</p></td>
<td><p>penalty for last-name commonness for second element in pair</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>thresholds</strong> (<em>dict</em>) – information about what blocking distances are allowed</p></li>
<li><p><strong>nn_string_expanded_df</strong> (<em>pd.DataFrame</em>) – maps a nn_string to a ed_string and absval_string</p></li>
<li><p><strong>nns_match</strong> (<em>bool</em>) – True if this function is called by get_exact_match_candidate_pairs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>chunk of the candidate-pairs list</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>blockstring_1</p></td>
<td><p>concatenated version of blocking columns for first element in pair (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>blockstring_2</p></td>
<td><p>concatenated version of blocking columns for second element in pair (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>cos_dist</p></td>
<td><p>approximate cosine distance between two nn_strings (nmslib)</p></td>
</tr>
<tr class="row-even"><td><p>edit_dist</p></td>
<td><p>number of character edits between ed-strings</p></td>
</tr>
<tr class="row-odd"><td><p>covered_pair</p></td>
<td><p>flag; 1 for pairs that made it through blocking, 0 otherwise; all 1s here</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.disallow_switched_pairs">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">disallow_switched_pairs</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#disallow_switched_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.disallow_switched_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Look through the columns nn_string_1 and nn_string_2 and keep only rows where
nn_string1 &lt;= nn_string2 to prevent duplicates in the end (i.e. ABBY-&gt;ZABBY &amp;
ZABBY-&gt;ABBY; only one is needed). Special case for incremental runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – holds similarity and commonness info about pairs of names</p></li>
<li><p><strong>incremental</strong> (<em>bool</em>) – Ture if current run incremental</p></li>
<li><p><strong>nn_strings_to_query</strong> (<em>list</em>) – nn_strings that are in “to query” list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>same as input df, but no AB/BA duplicates</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.generate_true_pairs">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">generate_true_pairs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">must_links_df</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#generate_true_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.generate_true_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the must-link records pairs must-link blockstring pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>must_links_df</strong> (<em>pd.DataFrame</em>) – <p>list of must-link record pairs</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>record_id_1</p></td>
<td><p>unique identifier for the first record in the pair</p></td>
</tr>
<tr class="row-even"><td><p>record_id_2</p></td>
<td><p>unique identifier for the second record in the pair</p></td>
</tr>
<tr class="row-odd"><td><p>blockstring_1</p></td>
<td><p>blockstring for the first record in the pair</p></td>
</tr>
<tr class="row-even"><td><p>blockstring_2</p></td>
<td><p>blockstring for the second record in the pair</p></td>
</tr>
<tr class="row-odd"><td><p>drop_from_nm_1</p></td>
<td><p>flag, 1 if the first record in the pair was not eligible for matching</p></td>
</tr>
<tr class="row-even"><td><p>drop_from_nm_2</p></td>
<td><p>flag, 1 if the second record in the pair was not eligible for matching</p></td>
</tr>
<tr class="row-odd"><td><p>existing</p></td>
<td><p>flag, 1 if the pair is must-link because of ExistingID</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>list of must-link blockstring pairs (where both record have drop_from_nm == 0)</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>blockstring_1</p></td>
<td><p>blockstring for the first record in the pair</p></td>
</tr>
<tr class="row-even"><td><p>blockstring_2</p></td>
<td><p>blockstring for the second record in the pair</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_actual_candidates">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_actual_candidates</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_actual_candidates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_actual_candidates" title="Permalink to this definition">¶</a></dt>
<dd><p>Actually determines whether two names become candidates; this function is launched by
generate_candidate_pairs() and run on individual worker threads to speed up processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>near_neighbors_df</strong> (<em>pd.DataFrame</em>) – <p>holds similarity and commonness info about pairs of names</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>nn_string_ix</p></td>
<td><p>a string with nn_string_ix = i is the string located at nn_strings_queried_this_batch[i]</p></td>
</tr>
<tr class="row-even"><td><p>nn_string_1</p></td>
<td><p>concatenated version of nn-blocking columns for first element in pair (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>nn_string_2</p></td>
<td><p>concatenated version of nn-blocking columns for second element in pair (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>cos_dist</p></td>
<td><p>approximate cosine distance between two nn_strings (nmslib)</p></td>
</tr>
<tr class="row-odd"><td><p>commonness_penalty_1</p></td>
<td><p>penalty for last-name commonness for first element in pair</p></td>
</tr>
<tr class="row-even"><td><p>commonness_penalty_2</p></td>
<td><p>penalty for last-name commonness for second element in pair</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>nn_string_expanded_df</strong> (<em>pandas dataframe</em>) – table at nn_string/ed_string/absval_string level (expanded if split_name is True)</p></li>
<li><p><strong>nn_strings_to_query</strong> (<em>list</em>) – nn_strings in the “to query” list (needed for incremental check)</p></li>
<li><p><strong>thresholds</strong> (<em>dict</em>) – information about what blocking distances are allowed</p></li>
<li><p><strong>incremental</strong> (<em>bool</em>) – True if current run incremental</p></li>
<li><p><strong>output</strong> – None if the output should be returned, rather than written</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>chunk of the candidate-pairs list</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>blockstring_1</p></td>
<td><p>concatenated version of blocking columns for first element in pair (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>blockstring_2</p></td>
<td><p>concatenated version of blocking columns for second element in pair (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>cos_dist</p></td>
<td><p>approximate cosine distance between two nn_strings (nmslib)</p></td>
</tr>
<tr class="row-even"><td><p>edit_dist</p></td>
<td><p>number of character edits between ed-strings</p></td>
</tr>
<tr class="row-odd"><td><p>covered_pair</p></td>
<td><p>flag; 1 for pairs that made it through blocking, 0 otherwise; all 1s here</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_all_shingles">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_all_shingles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_all_shingles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_all_shingles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all valid 2-shingles.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>valid 2-shingles</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_blocking_columns">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_blocking_columns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocking_scheme</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_blocking_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_blocking_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of blocking variables for each type of blocking:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>blocking_scheme</strong> (<em>dict</em>) – dictionary with info on how to do blocking</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the variable names needed for each type of blocking</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of string list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_common_name_penalties">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_common_name_penalties</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">clean_last_names</span></em>, <em class="sig-param"><span class="n">max_penalty</span></em>, <em class="sig-param"><span class="n">num_threshold_bins</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_common_name_penalties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_common_name_penalties" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dictionary mapping each last name to a “commonness penalty.” Two SMITHs are
less likely to be the same person than two HANDAs, since SMITH is such a common name. This
function quantifies this penalty for use in later blocking calculations. A more common name
recieves a higher number, topping out at max_penalty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clean_last_names</strong> (<em>pd.Series</em>) – clean (un-split) last name column (one row per record)</p></li>
<li><p><strong>max_penalty</strong> (<em>float</em>) – the maximum penalty (for the most common names)</p></li>
<li><p><strong>num_threshold_bins</strong> (<em>int</em>) – number of different categories of commonnness to create</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary mapping name (str) to penalty (float)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_exact_match_candidate_pairs">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_exact_match_candidate_pairs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nn_string_info_multi</span></em>, <em class="sig-param"><span class="n">nn_string_expanded_df</span></em>, <em class="sig-param"><span class="n">blocking_thresholds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_exact_match_candidate_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_exact_match_candidate_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>All nn_strings that appear more than once need to have a corresponding
nn_string, nn_string candidate pair – we can skip the “approximation” easily
for this type of candidate pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nn_string_info_multi</strong> (<em>pd.DataFrame</em>) – nn_string_info, subset to nn_strings with n_new &gt; 0 &amp; n_total &gt; 1</p></li>
<li><p><strong>nn_string_expanded_df</strong> (<em>pd.DataFrame</em>) – table at nn_string/ed_string/absval_string level (expanded if split_name is True)</p></li>
<li><p><strong>blocking_thresholds</strong> (<em>dict</em>) – dictionary with thresholds for blocking, e.g. high and low bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>portion of the candidate pairs list (where nn_string_1 == nn_string_2)</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>nn_string</p></td>
<td><p>concatenated version of nn-blocking columns (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>commonness_penalty</p></td>
<td><p>float indicating how common the last name is</p></td>
</tr>
<tr class="row-odd"><td><p>n_new</p></td>
<td><p>number of times this nn_string appears in a “new” record</p></td>
</tr>
<tr class="row-even"><td><p>n_existing</p></td>
<td><p>number of times this nn_string appears in an “existing” record</p></td>
</tr>
<tr class="row-odd"><td><p>n_total</p></td>
<td><p>number of times this nn_string appears in any record</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_near_neighbors_df">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_near_neighbors_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_near_neighbors_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_near_neighbors_df" title="Permalink to this definition">¶</a></dt>
<dd><p>For a small batch of names (nn_strings_queried_this_batch), format a dataframe that
enumerates every pair of (name in this batch, a near neighbor), along with information about
similarity and commonness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>near_neighbors_list</strong> (<em>list</em>) – list of (list of k IDs, list of k distances) tuples, of length batch_size</p></li>
<li><p><strong>nn_string_info</strong> (<em>pd.DataFrame</em>) – table mapping nn_string to commonness_penalty</p></li>
<li><p><strong>nn_strings_this_index</strong> (<em>list</em>) – nn_strings in the current index</p></li>
<li><p><strong>nn_strings_queried_this_batch</strong> (<em>list</em>) – nn_strings in the current query batch (length batch_size),
whose neighbors are stored in near_neighbors_list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>holds similarity and commonness info about pairs of names</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>nn_string_ix</p></td>
<td><p>a string with nn_string_ix = i is the string located at nn_strings_queried_this_batch[i]</p></td>
</tr>
<tr class="row-even"><td><p>nn_string_1</p></td>
<td><p>concatenated version of nn-blocking columns for first element in pair (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>nn_string_2</p></td>
<td><p>concatenated version of nn-blocking columns for second element in pair (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>cos_dist</p></td>
<td><p>approximate cosine distance between two nn_strings (nmslib)</p></td>
</tr>
<tr class="row-odd"><td><p>commonness_penalty_1</p></td>
<td><p>penalty for last-name commonness for first element in pair</p></td>
</tr>
<tr class="row-even"><td><p>commonness_penalty_2</p></td>
<td><p>penalty for last-name commonness for second element in pair</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_nn_string_counts">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_nn_string_counts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">an</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_nn_string_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_nn_string_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Count number of records per nn_strings (per file_type).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>an</strong> (<em>pd.DataFrame</em>) – all-names table, relevant columns only (where drop_from_nm == 0)
======================   =======================================================
record_id                unique record identifier
blockstring              concatenation of all the blocking variables (sep by ::)
file_type                either “new” or “existing”
drop_from_nm             flag, 1 if met any “to drop” criteria 0 otherwise
&lt;nn-blocking column(s)&gt;  variables for near-neighbor blocking
&lt;ed-blocking column&gt;     variable for edit-distance blocking
&lt;av-blocking column&gt;     (optional) variable for abs-value blocking
nn_string                concatenated version of nm-blocking columns (sep by ::)
ed_string                copy of ed-blocking column
absval_string            copy of ed-blocking column
======================   =======================================================</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>two keys (new and existing), mapping to a dictionary of nn_strings to n_records</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.get_second_index_nn_strings">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">get_second_index_nn_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">all_nn_strings</span></em>, <em class="sig-param"><span class="n">main_nn_strings</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#get_second_index_nn_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.get_second_index_nn_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Get nn_strings that haven’t already been stored in the main index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_nn_strings</strong> (<em>list</em>) – list of all nn_strings in the data (expanded if split_names is True)</p></li>
<li><p><strong>main_nn_strings</strong> (<em>list</em>) – list of nn_strings already in the main index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the nn_strings that are not in main_nn_strings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.load_main_index_nn_strings">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">load_main_index_nn_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">og_blocking_index_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#load_main_index_nn_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.load_main_index_nn_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the nn_strings that are in an existing nmslbi index file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>og_blocking_index_file</strong> (<em>str</em>) – path to original blocking index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loaded list of nn_strings in an existing nmslib index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.prep_index">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">prep_index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#prep_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.prep_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize index data structure, which will store similarity information
about the names, and load processed shingles into it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>nmslib index object (pre time-consuming build call)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.read_an">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">read_an</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">an_file</span></em>, <em class="sig-param"><span class="n">nn_cols</span></em>, <em class="sig-param"><span class="n">ed_col</span></em>, <em class="sig-param"><span class="n">absval_col</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#read_an"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.read_an" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in relevant columns for blocking from the all-names file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>an_file</strong> (<em>str</em>) – path to output_temp’s all-names file</p></li>
<li><p><strong>nn_cols</strong> (<em>list of strings</em>) – variables for near neighbor blocking</p></li>
<li><p><strong>ed_col</strong> (<em>list of strings</em>) – variables for edit-distance blocking</p></li>
<li><p><strong>absval_col</strong> (<em>list of strings</em>) – variables for absolute-value blocking</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>all-names dataframe, relevant columns only (where drop_from_nm == 0)</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>record_id</p></td>
<td><p>unique record identifier</p></td>
</tr>
<tr class="row-even"><td><p>blockstring</p></td>
<td><p>concatenation of all the blocking variables (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>file_type</p></td>
<td><p>either “new” or “existing”</p></td>
</tr>
<tr class="row-even"><td><p>drop_from_nm</p></td>
<td><p>flag, 1 if met any “to drop” criteria 0 otherwise</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;nn-blocking column(s)&gt;</p></td>
<td><p>variables for near-neighbor blocking</p></td>
</tr>
<tr class="row-even"><td><p>&lt;ed-blocking column&gt;</p></td>
<td><p>variable for edit-distance blocking</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;av-blocking column&gt;</p></td>
<td><p>(optional) variable for abs-value blocking</p></td>
</tr>
<tr class="row-even"><td><p>nn_string</p></td>
<td><p>concatenated version of nm-blocking columns (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>ed_string</p></td>
<td><p>copy of ed-blocking column</p></td>
</tr>
<tr class="row-even"><td><p>absval_string</p></td>
<td><p>copy of ed-blocking column</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.save_main_index">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">save_main_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">main_index</span></em>, <em class="sig-param"><span class="n">main_index_nn_strings</span></em>, <em class="sig-param"><span class="n">main_index_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#save_main_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.save_main_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the main nmslib index and pickle dump the associated nn_strings list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_index</strong> (<em>nsmlib index</em>) – the main, built nmslib index</p></li>
<li><p><strong>main_index_nn_strings</strong> (<em>list</em>) – list of nn_strings in the main index</p></li>
<li><p><strong>main_index_file</strong> (<em>str</em>) – path to store the main nmslib index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.block.write_some_cps">
<code class="sig-prename descclassname">namematch.block.</code><code class="sig-name descname">write_some_cps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cand_pairs</span></em>, <em class="sig-param"><span class="n">output_file</span></em>, <em class="sig-param"><span class="n">header</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/block.html#write_some_cps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.block.write_some_cps" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out a portion of the candidate-pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_pairs</strong> (<em>pd.DataFrame</em>) – chunk of the candidate-pairs file</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – path to output_temp’s candidate-pairs file</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – True if this is the first time calling this function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch.cluster">
<span id="namematch-cluster-module"></span><h2>namematch.cluster module<a class="headerlink" href="#module-namematch.cluster" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.cluster.Cluster">
<em class="property">class </em><code class="sig-prename descclassname">namematch.cluster.</code><code class="sig-name descname">Cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">schema</span></em>, <em class="sig-param"><span class="n">constraints_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">must_links_file</span><span class="o">=</span><span class="default_value">'output_temp/must_links.csv'</span></em>, <em class="sig-param"><span class="n">potential_edges_dir</span><span class="o">=</span><span class="default_value">'output_temp/potential_edges'</span></em>, <em class="sig-param"><span class="n">flipped0_edges_file</span><span class="o">=</span><span class="default_value">'flipped0_potential_edges.csv'</span></em>, <em class="sig-param"><span class="n">all_names_file</span><span class="o">=</span><span class="default_value">'output_temp/all_names.parquet'</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">'output_temp/cluster_assignments.pkl'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/cluster.html#Cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.cluster.Cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.cluster.Cluster.auto_is_valid_cluster">
<code class="sig-name descname">auto_is_valid_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/cluster.html#Cluster.auto_is_valid_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.cluster.Cluster.auto_is_valid_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a proposed cluster would violate a unique id or existing id constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> (<em>pd.DataFrame</em>) – all-names file (relevant columns only) records for the proposed cluster</p></li>
<li><p><strong>uid_cols</strong> (<em>list</em>) – all-names column(s) with compare_type UniqueID</p></li>
<li><p><strong>allow_clusters_w_multiple_unique_ids</strong> (<em>bool</em>) – True if a cluster can have multiple uid values</p></li>
<li><p><strong>leven_thresh</strong> (<em>int</em>) – n character edits to allow between uids before they’re considered different</p></li>
<li><p><strong>eid_col</strong> (<em>str</em>) – all-names column with compare_type ExistingID (None for non-incremental runs)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>False if an automated constraint is violated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.cluster.Cluster.auto_is_valid_edge">
<code class="sig-name descname">auto_is_valid_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/cluster.html#Cluster.auto_is_valid_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.cluster.Cluster.auto_is_valid_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if two records would violate a unique id or existing id constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record1</strong> (<em>pd.Series</em>) – one row of the all-names file (relevant columns only)</p></li>
<li><p><strong>record2</strong> (<em>pd.Series</em>) – one row of the all-names file (relevant columns only)</p></li>
<li><p><strong>uid_cols</strong> (<em>list</em>) – all-names column(s) with compare_type UniqueID</p></li>
<li><p><strong>allow_clusters_w_multiple_unique_ids</strong> (<em>bool</em>) – True if a cluster can have multiple uid values</p></li>
<li><p><strong>leven_thresh</strong> (<em>int</em>) – n character edits to allow between uids before they’re considered different</p></li>
<li><p><strong>eid_col</strong> (<em>str</em>) – all-names column with compare_type ExistingID (None for non-incremental runs)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>False if an automated constraint is violated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.cluster.Cluster.cluster_potential_edges">
<code class="sig-name descname">cluster_potential_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.cluster.Cluster.cluster_potential_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.Cluster.get_initial_clusters">
<code class="sig-name descname">get_initial_clusters</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.cluster.Cluster.get_initial_clusters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.Cluster.get_potential_edges">
<code class="sig-name descname">get_potential_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.cluster.Cluster.get_potential_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.Cluster.load_cluster_info">
<code class="sig-name descname">load_cluster_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.cluster.Cluster.load_cluster_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.Cluster.main__cluster">
<code class="sig-name descname">main__cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.cluster.Cluster.main__cluster" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="namematch.cluster.ClusterConstraints">
<em class="property">class </em><code class="sig-prename descclassname">namematch.cluster.</code><code class="sig-name descname">ClusterConstraints</code><a class="reference internal" href="_modules/namematch/cluster.html#ClusterConstraints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.cluster.ClusterConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="namematch.cluster.ClusterConstraints.apply_edge_priority">
<em class="property">property </em><code class="sig-name descname">apply_edge_priority</code><a class="headerlink" href="#namematch.cluster.ClusterConstraints.apply_edge_priority" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.ClusterConstraints.get_columns_used">
<em class="property">property </em><code class="sig-name descname">get_columns_used</code><a class="headerlink" href="#namematch.cluster.ClusterConstraints.get_columns_used" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.ClusterConstraints.is_valid_cluster">
<em class="property">property </em><code class="sig-name descname">is_valid_cluster</code><a class="headerlink" href="#namematch.cluster.ClusterConstraints.is_valid_cluster" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.cluster.ClusterConstraints.is_valid_edge">
<em class="property">property </em><code class="sig-name descname">is_valid_edge</code><a class="headerlink" href="#namematch.cluster.ClusterConstraints.is_valid_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.comparison_functions">
<span id="namematch-comparison-functions-module"></span><h2>namematch.comparison_functions module<a class="headerlink" href="#module-namematch.comparison_functions" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="namematch.comparison_functions.compare_categories">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">compare_categories</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#compare_categories"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.compare_categories" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute categorical distances between two records for a particular matching field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>varname</strong> (<em>str</em>) – name of the all-names column to compute distance measures for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>features associated with the current variable</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>&lt;var&gt;_missing</p></td>
<td><p>flag, 1 if either record is missing the value for this field</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;_exact_match</p></td>
<td><p>flag, 1 if categories are identical</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;var&gt;_partial_match</p></td>
<td><p>flag, 1 if any part of the categories (split by ” “) match</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.compare_dates">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">compare_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#compare_dates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.compare_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute date distances between two records for a particular matching field.
NOTE: The date MUST be in the format yyyy-mm-dd (handled upstream).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>varname</strong> (<em>str</em>) – name of the all-names column to compute distance measures for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>features associated with the current variable</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>&lt;var&gt;_missing</p></td>
<td><p>flag, 1 if either record is missing the value for this field</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;_edit_dist</p></td>
<td><p>number of character edits between two date values</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;var&gt;_day_diff</p></td>
<td><p>number of days between two date values</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.compare_geographies">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">compare_geographies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">varname</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#compare_geographies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.compare_geographies" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute geographic distance between two records for a particular matching field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>varname</strong> (<em>str</em>) – name of the all-names column to compute distance measures for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>features associated with the current variable</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>&lt;var&gt;_missing</p></td>
<td><p>flag, 1 if either record is missing the value for this field</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;_geog_dist</p></td>
<td><p>euclidian distance between two geographic points</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.compare_numbers">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">compare_numbers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">varname</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#compare_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.compare_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute numeric distances between two records for a particular matching field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>varname</strong> (<em>str</em>) – name of the all-names column to compute distance measures for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>features associated with the current variable</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>&lt;var&gt;_missing</p></td>
<td><p>flag, 1 if either record is missing the value for this field</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;_num_diff</p></td>
<td><p>numeric difference between two field valies</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.compare_strings">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">compare_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#compare_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.compare_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute string distances between two records for a particular matching field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>varname</strong> (<em>str</em>) – name of the all-names column to compute distance measures for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>features associated with the current variable</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>&lt;var&gt;_missing</p></td>
<td><p>flag, 1 if either record is missing the value for this field</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;_edit_dist</p></td>
<td><p>number of character edits between whole strings</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;var&gt;_exact_match</p></td>
<td><p>flag, 1 if whole string matches</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;_exact_match_1st</p></td>
<td><p>flag, 1 if first charcater matches</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;var&gt;_exact_match_1st2nd3rd</p></td>
<td><p>flag, 1 if first three characters match</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;__soundex</p></td>
<td><p>flag, 1 if the soundex codes match</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;var&gt;__nysiis</p></td>
<td><p>flag, 1 if the nysiis codes match</p></td>
</tr>
<tr class="row-even"><td><p>&lt;var&gt;__jw_dist</p></td>
<td><p>jarowinkler distance (float)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.generate_label">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">generate_label</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#generate_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.generate_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a column indicating whether the UIDs of a pair of people is a match. The value is 1
if UIDs are non-missing match, 0 if UIDs are non-missing and don’t match, and missing if either
UID is missing or if (0 &lt; edit distance &lt;= <cite>leven_thresh</cite>).</p>
<p>The <cite>leven_thresh</cite> will never flip a mismatch to a match, only to a missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>uid_vars</strong> (<em>list</em>) – column name(s) of the UniqueID variable(s)</p></li>
<li><p><strong>leven_thresh</strong> (<em>int</em>) – n character edits to allow between uids, below which 0 labels will get flipped to “”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>label column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.get_name_probabilities">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">get_name_probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#get_name_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.get_name_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the name-probabilities package to assesess the likelihood of a pair of names
being the same person.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table</p></li>
<li><p><strong>np_object</strong> (<em>NameMatcher object</em>) – contains info about name probabilities</p></li>
<li><p><strong>first_name_col</strong> (<em>str</em>) – name of first-name column</p></li>
<li><p><strong>last_name_col</strong> (<em>str</em>) – name of last-name column</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>side-by-side table with a few new name-probability columns</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.comparison_functions.try_switch_first_last_name">
<code class="sig-prename descclassname">namematch.comparison_functions.</code><code class="sig-name descname">try_switch_first_last_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/comparison_functions.html#try_switch_first_last_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.comparison_functions.try_switch_first_last_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The input df to this function is the output of get_name_probabilities. Using the probabilities
calculated above, it decides whether the names labelled as FIRST and LAST were swapped. If they
are, it fixes the swap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – side-by-side table with a few new name-probability columns</p></li>
<li><p><strong>first_name_col</strong> (<em>str</em>) – name of first-name column</p></li>
<li><p><strong>last_name_col</strong> (<em>str</em>) – name of last-name column</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>side-by-side table with a few new name-probability columns (names swapped as needed)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch.default_cluster_constraints">
<span id="namematch-default-cluster-constraints-module"></span><h2>namematch.default_cluster_constraints module<a class="headerlink" href="#module-namematch.default_cluster_constraints" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="namematch.default_cluster_constraints.apply_edge_priority">
<code class="sig-prename descclassname">namematch.default_cluster_constraints.</code><code class="sig-name descname">apply_edge_priority</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edges_df</span></em>, <em class="sig-param"><span class="n">records_df</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/default_cluster_constraints.html#apply_edge_priority"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.default_cluster_constraints.apply_edge_priority" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust the order in which potential edges will be considered by altering
the phat (predicted probability of a record pair being a match). Edges will be
considered in decreasing order of phat. For the vast majority of runs, the default
behaviour of doing nothing is best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges_df</strong> (<em>pd.DataFrame</em>) – potential edges information
================      =======================================================
record_id_1           unique record identifier (for first in pair)
record_id_2           unique record identifier (for second in pair)
phat                     predicted probability of a record pair being a match
================      =======================================================</p></li>
<li><p><strong>records_df</strong> (<em>pd.DataFrame</em>) – all-names file (relevant columns only)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>same as input, with phat columns potentially adjusted</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.default_cluster_constraints.get_columns_used">
<code class="sig-prename descclassname">namematch.default_cluster_constraints.</code><code class="sig-name descname">get_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/default_cluster_constraints.html#get_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.default_cluster_constraints.get_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>get_columns_used()</cite> function returns a dictionary mapping data fields needed for
constraint checking to the datatype they should be read in as. For this defaultversion,
it simply returns an empty dictionary.</p>
<p>Special note: if you want something to be treated as a date, use
dtype “date” (will be converted to a valid pandas dtype internally).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>empty for default version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.default_cluster_constraints.is_valid_cluster">
<code class="sig-prename descclassname">namematch.default_cluster_constraints.</code><code class="sig-name descname">is_valid_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cluster</span></em>, <em class="sig-param"><span class="n">phat</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/default_cluster_constraints.html#is_valid_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.default_cluster_constraints.is_valid_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a proposed cluster is valid. For this default version,
it simply returns True. The information you’ll have access to for the
cluster’s records is determined by the column(s) specified in <cite>get_columns_used</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> (<em>pd.DataFrame</em>) – all-names file (relevant columns only) records for the proposed cluster</p></li>
<li><p><strong>phat</strong> (<em>float</em>) – phat value of the proposed edge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True for default version</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.default_cluster_constraints.is_valid_edge">
<code class="sig-prename descclassname">namematch.default_cluster_constraints.</code><code class="sig-name descname">is_valid_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record1</span></em>, <em class="sig-param"><span class="n">record2</span></em>, <em class="sig-param"><span class="n">phat</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/default_cluster_constraints.html#is_valid_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.default_cluster_constraints.is_valid_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if two records would form a valid link, or edge. For this default version,
it simply returns True.</p>
<p>Special note: for fields read in as dtype object (above), NAs have been filled with “”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record1</strong> (<em>pd.Series</em>) – one row of the all-names file (relevant columns only)</p></li>
<li><p><strong>record2</strong> (<em>pd.Series</em>) – one row of the all-names file (relevant columns only)</p></li>
<li><p><strong>phat</strong> (<em>float</em>) – phat value of the proposed edge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True for default version</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch.fit_model">
<span id="namematch-fit-model-module"></span><h2>namematch.fit_model module<a class="headerlink" href="#module-namematch.fit_model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.fit_model.FitModel">
<em class="property">class </em><code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">FitModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">all_names_file</span><span class="o">=</span><span class="default_value">'output_temp/all_names.parquet'</span></em>, <em class="sig-param"><span class="n">data_rows_dir</span><span class="o">=</span><span class="default_value">'output_temp/data_rows'</span></em>, <em class="sig-param"><span class="n">trained_model_info_file</span><span class="o">=</span><span class="default_value">'None'</span></em>, <em class="sig-param"><span class="n">selection_model_path</span><span class="o">=</span><span class="default_value">'basic_selection_model.pkl'</span></em>, <em class="sig-param"><span class="n">match_model_path</span><span class="o">=</span><span class="default_value">'basic_match_model.pkl'</span></em>, <em class="sig-param"><span class="n">flipped0_file</span><span class="o">=</span><span class="default_value">'flipped0_potential_edges.csv'</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">'output_temp/model/model.yaml'</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="o">=</span><span class="default_value">'output_temp/model'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#FitModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.FitModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.fit_model.FitModel.evaluate_models">
<code class="sig-name descname">evaluate_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.fit_model.FitModel.evaluate_models" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.fit_model.FitModel.fit_model">
<code class="sig-name descname">fit_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.fit_model.FitModel.fit_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.fit_model.FitModel.fit_models">
<code class="sig-name descname">fit_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_df</span></em>, <em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">model_info</span></em>, <em class="sig-param"><span class="n">prob_match_train</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#FitModel.fit_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.FitModel.fit_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit random forest model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_df</strong> (<em>pd.DataFrame</em>) – data rows, subset to training rows</p></li>
<li><p><strong>model_type</strong> (<em>string</em>) – either “selection” or “match”</p></li>
<li><p><strong>model_info</strong> (<em>dict</em>) – dict with information about how to fit the model</p></li>
<li><p><strong>prob_match_train</strong> (<em>float</em>) – share of data-rows that are labeled</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – path to output_temp folder <strong>optional and temporary while implementing weights</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>maps model name (e.g. basic or no_dob) to a trained model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.fit_model.FitModel.main__fit_model">
<code class="sig-name descname">main__fit_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.fit_model.FitModel.main__fit_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.add_threshold_dict">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">add_threshold_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_info</span></em>, <em class="sig-param"><span class="n">thresholds_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#add_threshold_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.add_threshold_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Add threshold information to the model_info dict, once it’s been determined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_info</strong> (<em>dict</em>) – dict with information about how to fit the model</p></li>
<li><p><strong>thresholds_dict</strong> (<em>dict</em>) – keys are model name (e.g. basic, no-dob), values are optimized thresholds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>model dict, now with threshold info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.define_necessary_models">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">define_necessary_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dr_file_list</span></em>, <em class="sig-param"><span class="n">output_dir</span></em>, <em class="sig-param"><span class="n">missing_mod_field</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">selection_model_path</span><span class="o">=</span><span class="default_value">'basic_selection_model.pkl'</span></em>, <em class="sig-param"><span class="n">match_model_path</span><span class="o">=</span><span class="default_value">'basic_match_model.pkl'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#define_necessary_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.define_necessary_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the different models needed (using a sample) and
define the characteristics of data that determine which
model should handle it.</p>
<dl class="simple">
<dt>NOTE: Right now, there is an assumption that the training universe</dt><dd><p>is the same between all models (i.e. basic and missingness)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dr_file_list</strong> (<em>list</em>) – list of paths to all data row files</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – model output folder path</p></li>
<li><p><strong>missing_mod_field</strong> (<em>str</em><em> or </em><em>None</em>) – field that could trigger need for separate model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>selection_model_path (str)
match_model_path (str)
type (str): one of “default” or “missingness”
actual_phat_universe (dict): maps a variable name to a value(?)
vars_to_exclude (str list)
match_thresh (float): threshold for match/nonmatch</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict mapping the name of a model (str) to a dict of the following information</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.get_feature_info">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">get_feature_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pipeline</span></em>, <em class="sig-param"><span class="n">raw_num_cols</span></em>, <em class="sig-param"><span class="n">raw_cat_cols</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#get_feature_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.get_feature_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the feature importance information from a sklearn model pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipeline</strong> (<em>skleran fitted pipeline</em>) – trained model</p></li>
<li><p><strong>raw_num_cols</strong> (<em>list</em>) – numeric columns that went into the model (before pipeline processing)</p></li>
<li><p><strong>raw_cat_cols</strong> (<em>list</em>) – categorical columns that went into the model (before pipeline processing)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>feature importance information</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>feature</p></td>
<td><p>name of the feautre</p></td>
</tr>
<tr class="row-even"><td><p>importance</p></td>
<td><p>relative importance of this feature to the model</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.get_flipped0_potential_edges">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">get_flipped0_potential_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phats_df</span></em>, <em class="sig-param"><span class="n">model_info</span></em>, <em class="sig-param"><span class="n">allow_clusters_w_multiple_unique_ids</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#get_flipped0_potential_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.get_flipped0_potential_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>If allowed, identify the set of labeled 0s with high phats so they can be treated
as matches downstream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phats_df</strong> (<em>pd.DataFrame</em>) – <p>phat info for record pairs</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>record_id (_1, _2)</p></td>
<td><p>unique record identifiers</p></td>
</tr>
<tr class="row-even"><td><p>model_to_use</p></td>
<td><p>based on pair characteristics, which model to use (e.g. basic or no-dob)</p></td>
</tr>
<tr class="row-odd"><td><p>covered_pair</p></td>
<td><p>did the pair make it through blocking</p></td>
</tr>
<tr class="row-even"><td><p>match_train_eligible</p></td>
<td><p>is the pair eligible for training (for match model)</p></td>
</tr>
<tr class="row-odd"><td><p>exactmatch</p></td>
<td><p>is the pair an exact match on name/dob</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>whether the pair is a match or not</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;phat_col&gt;</p></td>
<td><p>predicted probability of match</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>model_info</strong> (<em>dict</em>) – dict with information about how to fit the model</p></li>
<li><p><strong>allow_clusters_w_multiple_unique_ids</strong> (<em>bool</em>) – param controlling if 0s can be flipped to 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>same as phats_df, just</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.get_match_train_eligible_flag">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">get_match_train_eligible_flag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">train_criteria</span></em>, <em class="sig-param"><span class="n">an_train_eligible_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#get_match_train_eligible_flag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.get_match_train_eligible_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if a data-row is eligible for training (for match models), according
to both all-names eligibility criteria and data-row eligibility criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – portion of data-rows file, limited to labeled rows</p></li>
<li><p><strong>train_criteria</strong> (<em>dict</em>) – contains data-row training eligibility criteria</p></li>
<li><p><strong>an_train_eligible_dict</strong> (<em>dict</em>) – maps record_id to flag indicating record’s all-names based training eligibility</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flag, 1 if data-row is training eligible (for match models)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.load_and_save_trained_model">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">load_and_save_trained_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trained_model_info_file</span></em>, <em class="sig-param"><span class="n">output_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#load_and_save_trained_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.load_and_save_trained_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a set of pre-trained models and copy them to the current run’s
output_temp. Typically only used in incremental runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trained_model_info_file</strong> (<em>str</em>) – path to a model yaml file, which has path/threshold/universe info</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – path to output the current run’s model yaml file (for copying)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>maps model name (e.g. basic or no_dob) to a trained model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.load_model_data">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">load_model_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dr_file_list</span></em>, <em class="sig-param"><span class="n">an_train_eligible_dict</span></em>, <em class="sig-param"><span class="n">model_info</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">any_train</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#load_model_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.load_model_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data-rows, filter to rows that are eligible for training a givem model type, and then split
the data into a training set and a labeled evaulation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dr_file_list</strong> (<em>str</em>) – list of output_temp’s data-row file paths</p></li>
<li><p><strong>an_train_eligible_dict</strong> (<em>dict</em>) – maps record_id to flag indicating record’s all-names based training eligibility</p></li>
<li><p><strong>model_info</strong> (<em>dict</em>) – dict with information about how to fit the model</p></li>
<li><p><strong>params</strong> (<em>Parameters object</em>) – contains parameter values</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – either “selection” or “match”</p></li>
<li><p><strong>any_train</strong> (<em>bool</em>) – True if you want training data (e.g. not a pre-trained model), False otherwise</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data rows, filtered to training data (excluding labeled eval data)
pd.DataFrame: data rows, filtered to labeled eval data
float: share of data rows that are labeled</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.fit_model.save_models">
<code class="sig-prename descclassname">namematch.fit_model.</code><code class="sig-name descname">save_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">selection_models</span></em>, <em class="sig-param"><span class="n">match_models</span></em>, <em class="sig-param"><span class="n">model_info</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/fit_model.html#save_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.fit_model.save_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the models to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection_models</strong> (<em>dict</em>) – maps model name (e.g. basic or no-dob) to a fit match model object</p></li>
<li><p><strong>match_models</strong> (<em>dict</em>) – maps model name (e.g. basic or no-dob) to a fit selection model object</p></li>
<li><p><strong>model_info</strong> (<em>dict</em>) – dict with information about how to fit the model</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch.generate_data_rows">
<span id="namematch-generate-data-rows-module"></span><h2>namematch.generate_data_rows module<a class="headerlink" href="#module-namematch.generate_data_rows" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.generate_data_rows.GenerateDataRows">
<em class="property">class </em><code class="sig-prename descclassname">namematch.generate_data_rows.</code><code class="sig-name descname">GenerateDataRows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">schema</span></em>, <em class="sig-param"><span class="n">all_names_file</span></em>, <em class="sig-param"><span class="n">candidate_pairs_file</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="o">=</span><span class="default_value">'output_temp/data_rows'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/generate_data_rows.html#GenerateDataRows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.generate_data_rows.GenerateDataRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.generate_data_rows.GenerateDataRows.find_valid_training_records">
<code class="sig-name descname">find_valid_training_records</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_data_rows.GenerateDataRows.find_valid_training_records" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.generate_data_rows.GenerateDataRows.generate_actual_data_rows">
<code class="sig-name descname">generate_actual_data_rows</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/generate_data_rows.html#GenerateDataRows.generate_actual_data_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.generate_data_rows.GenerateDataRows.generate_actual_data_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Create modeling dataframe by comparing each variable (via numerous distance metrics).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Parameters object</em>) – contains matching parameters</p></li>
<li><p><strong>schema</strong> (<em>Schema object</em>) – contains matching schema (data files and variables)</p></li>
<li><p><strong>sbs_df</strong> (<em>pd.DatFrame</em>) – <p>side-by-side table (record pair level, with info from both an records)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>record_id (_1, _2)</p></td>
<td><p>unique record identifier</p></td>
</tr>
<tr class="row-even"><td><p>blockstring (_1, _2)</p></td>
<td><p>concatenated version of blocking columns (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>file_type (_1, _2)</p></td>
<td><p>either “new” or “existing”</p></td>
</tr>
<tr class="row-even"><td><p>candidate_pair_ix</p></td>
<td><p>index from candidate-pairs list</p></td>
</tr>
<tr class="row-odd"><td><p>covered_pair</p></td>
<td><p>flag, 1 if blockstring pair passed blocking 0 otherwise</p></td>
</tr>
<tr class="row-even"><td><p>&lt;fields for matching&gt; (_1, _2)</p></td>
<td><p>both for the matching model and for constraint checking</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>np_object</strong> (<em>nm_prob.NameMatcher object</em>) – contains information about name probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>chunk of the data-rows file</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>dr_id</p></td>
<td><p>unique record pair identifier (record_id_1__record_id_2)</p></td>
</tr>
<tr class="row-even"><td><p>record_id (_1, _2)</p></td>
<td><p>unique record identifiers</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;distance metrics&gt;</p></td>
<td><p>how similar are the different matching fields between recrods</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>”1” if the records refer to the same person, “0” if not, “” otherwise</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.generate_data_rows.GenerateDataRows.generate_data_row_files">
<code class="sig-name descname">generate_data_row_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_data_rows.GenerateDataRows.generate_data_row_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.generate_data_rows.GenerateDataRows.generate_name_probabilities_object">
<code class="sig-name descname">generate_name_probabilities_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_data_rows.GenerateDataRows.generate_name_probabilities_object" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.generate_data_rows.GenerateDataRows.main__generate_data_rows">
<code class="sig-name descname">main__generate_data_rows</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_data_rows.GenerateDataRows.main__generate_data_rows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.generate_must_links">
<span id="namematch-generate-must-links-module"></span><h2>namematch.generate_must_links module<a class="headerlink" href="#module-namematch.generate_must_links" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.generate_must_links.GenerateMustLinks">
<em class="property">class </em><code class="sig-prename descclassname">namematch.generate_must_links.</code><code class="sig-name descname">GenerateMustLinks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">schema</span></em>, <em class="sig-param"><span class="n">all_names_file</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">'output_temp/must_links.csv'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/generate_must_links.html#GenerateMustLinks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.generate_must_links.GenerateMustLinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.generate_must_links.GenerateMustLinks.build_ml_var_df">
<code class="sig-name descname">build_ml_var_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">all_names_file</span></em>, <em class="sig-param"><span class="n">uid_vars_list</span></em>, <em class="sig-param"><span class="n">eid_vars_list</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/generate_must_links.html#GenerateMustLinks.build_ml_var_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.generate_must_links.GenerateMustLinks.build_ml_var_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the all-names file and limit it to the rows that have either
a non-missing UniqueID or ExistingID value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_names_file</strong> (<em>str</em>) – path to output_temp’s all-names file</p></li>
<li><p><strong>uid_vars_list</strong> (<em>list of strings</em>) – all-name columns with compare_type “UniqueID”</p></li>
<li><p><strong>eid_vars_list</strong> (<em>list of strings</em>) – all-name columns with compare_type “ExistingID”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>a subset of the all-names file, relevant colums only</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>record_id</p></td>
<td><p>unique record identifier</p></td>
</tr>
<tr class="row-even"><td><p>blockstring</p></td>
<td><p>concatenation of all the blocking variables (sep by ::)</p></td>
</tr>
<tr class="row-odd"><td><p>file_type</p></td>
<td><p>either “new” or “existing”</p></td>
</tr>
<tr class="row-even"><td><p>drop_from_nm</p></td>
<td><p>flag, 1 if met any “to drop” criteria 0 otherwise</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;UniqueID column(s)&gt;</p></td>
<td><p>variables of compare_type UniqueID</p></td>
</tr>
<tr class="row-even"><td><p>&lt;ExistingID column(s)&gt;</p></td>
<td><p>variables of compare_type ExistingID</p></td>
</tr>
<tr class="row-odd"><td><p>has_ml_var</p></td>
<td><p>flag, always 1 in output (ml stands for must-link)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.generate_must_links.GenerateMustLinks.get_must_links">
<code class="sig-name descname">get_must_links</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_must_links.GenerateMustLinks.get_must_links" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.generate_must_links.GenerateMustLinks.main__generate_must_links">
<code class="sig-name descname">main__generate_must_links</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_must_links.GenerateMustLinks.main__generate_must_links" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.generate_output">
<span id="namematch-generate-output-module"></span><h2>namematch.generate_output module<a class="headerlink" href="#module-namematch.generate_output" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.generate_output.GenerateOutput">
<em class="property">class </em><code class="sig-prename descclassname">namematch.generate_output.</code><code class="sig-name descname">GenerateOutput</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">schema</span></em>, <em class="sig-param"><span class="n">all_names_file</span><span class="o">=</span><span class="default_value">'output_temp/all_names.parquet'</span></em>, <em class="sig-param"><span class="n">cluster_assignments_file</span><span class="o">=</span><span class="default_value">'output_temp/cluster_assignments.pkl'</span></em>, <em class="sig-param"><span class="n">an_output_file</span><span class="o">=</span><span class="default_value">'output_temp/all_names_with_clusterid.csv'</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="o">=</span><span class="default_value">'output'</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_file_uuid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/generate_output.html#GenerateOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.generate_output.GenerateOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.generate_output.GenerateOutput.create_allnames_clusterid_file">
<code class="sig-name descname">create_allnames_clusterid_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_output.GenerateOutput.create_allnames_clusterid_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.generate_output.GenerateOutput.main__generate_output">
<code class="sig-name descname">main__generate_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_output.GenerateOutput.main__generate_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.generate_output.GenerateOutput.output_clusterid_files">
<code class="sig-name descname">output_clusterid_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.generate_output.GenerateOutput.output_clusterid_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.model_evaluation_functions">
<span id="namematch-model-evaluation-functions-module"></span><h2>namematch.model_evaluation_functions module<a class="headerlink" href="#module-namematch.model_evaluation_functions" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="namematch.model_evaluation_functions.evaluate_models">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">evaluate_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phats_df</span></em>, <em class="sig-param"><span class="n">outcome</span></em>, <em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">default_threshold</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">missingness_model_threshold_boost</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">optimize_threshold</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fscore_beta</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#evaluate_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.evaluate_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for evaluating different models (e.g. basic and no-dob) on different universes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phat_df</strong> (<em>pd.DataFrame</em>) – df with labeled test phats and columns needed for evaluation</p></li>
<li><p><strong>outcome</strong> (<em>str</em>) – outcome to evaluate</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – either “selection” or “match”</p></li>
<li><p><strong>default_threshold</strong> (<em>float</em>) – threshold for match/non-match (use if don’t find optimal)</p></li>
<li><p><strong>missingness_model_threshold_boost</strong> (<em>float</em>) – value to add to default threshold if missingess model (use if don’t find optimal)</p></li>
<li><p><strong>optimize_threshold</strong> (<em>bool</em>) – should we find the threshold that optimizes fscore</p></li>
<li><p><strong>fscore_beta</strong> (<em>float</em>) – ratio of recall weighting to precision weighting (e.g. 0.5 weights precision double)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>maps model name (e.g. basic, no-dob) to thresholds (no return type)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.get_accuracy">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">get_accuracy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preds</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">thresh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#get_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.get_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>pd.Series</em>) – predicted probabilty of match (float), for a set of labeled record pairs</p></li>
<li><p><strong>labels</strong> (<em>pd.Series</em>) – flag, 1 if the record pairs are actually a match 0 otherwise</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accuracy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.get_confusion_matrix">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">get_confusion_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preds</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">thresh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#get_confusion_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.get_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute confusion matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>pd.Series</em>) – predicted probabilty of match (float), for a set of labeled record pairs</p></li>
<li><p><strong>labels</strong> (<em>pd.Series</em>) – flag, 1 if the record pairs are actually a match 0 otherwise</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>confusion matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.get_fpr">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">get_fpr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preds</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">thresh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#get_fpr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.get_fpr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute false postive rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>pd.Series</em>) – predicted probabilty of match (float), for a set of labeled record pairs</p></li>
<li><p><strong>labels</strong> (<em>pd.Series</em>) – flag, 1 if the record pairs are actually a match 0 otherwise</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>false positive rate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.get_fscore">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">get_fscore</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preds</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">thresh</span></em>, <em class="sig-param"><span class="n">beta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#get_fscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.get_fscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute fscore.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>pd.Series</em>) – predicted probabilty of match (float), for a set of labeled record pairs</p></li>
<li><p><strong>labels</strong> (<em>pd.Series</em>) – flag, 1 if the record pairs are actually a match 0 otherwise</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – ratio of recall weighting to precision weighting (e.g. 0.5 weights precision double)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fscore</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.get_precision">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">get_precision</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preds</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">thresh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#get_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.get_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute precision.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>pd.Series</em>) – predicted probabilty of match (float), for a set of labeled record pairs</p></li>
<li><p><strong>labels</strong> (<em>pd.Series</em>) – flag, 1 if the record pairs are actually a match 0 otherwise</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>precision</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.get_recall">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">get_recall</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preds</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">thresh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#get_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.get_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute recall.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>pd.Series</em>) – predicted probabilty of match (float), for a set of labeled record pairs</p></li>
<li><p><strong>labels</strong> (<em>pd.Series</em>) – flag, 1 if the record pairs are actually a match 0 otherwise</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>recall</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.model_evaluation_functions.pairwise_metrics">
<code class="sig-prename descclassname">namematch.model_evaluation_functions.</code><code class="sig-name descname">pairwise_metrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labeled_preds</span></em>, <em class="sig-param"><span class="n">threshold</span></em>, <em class="sig-param"><span class="n">phat_col</span></em>, <em class="sig-param"><span class="n">outcome</span></em>, <em class="sig-param"><span class="n">fscore_beta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/model_evaluation_functions.html#pairwise_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.model_evaluation_functions.pairwise_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate evaluation metrics that are standard for classification problems (e.g. precision, auc).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labeled_preds</strong> (<em>pd.DataFrame</em>) – df with labeled test phats and columns needed for evaluation (limited to a universe)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – probability threshold that optimizes fscore</p></li>
<li><p><strong>phat_col</strong> – phat column for evaluation</p></li>
<li><p><strong>outcome</strong> – outcome to evaluate</p></li>
<li><p><strong>fscore_beta</strong> – ratio of recall weighting to precision weighting (e.g. 0.5 weights precision double)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>base_rate, precision, recall, fpr, fnr, auc, accuracy, fscore</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of floats</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch.namematcher">
<span id="namematch-namematcher-module"></span><h2>namematch.namematcher module<a class="headerlink" href="#module-namematch.namematcher" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.namematcher.NameMatcher">
<em class="property">class </em><code class="sig-prename descclassname">namematch.namematcher.</code><code class="sig-name descname">NameMatcher</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">private_config</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">input_data_batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">50000</span></em>, <em class="sig-param"><span class="n">data_row_batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">500</span></em>, <em class="sig-param"><span class="n">log_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logging_params_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'output'</span></em>, <em class="sig-param"><span class="n">output_temp_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'output_temp'</span></em>, <em class="sig-param"><span class="n">all_name_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'all_names.parquet'</span></em>, <em class="sig-param"><span class="n">must_links</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'must_links.csv'</span></em>, <em class="sig-param"><span class="n">og_blocking_index_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'None'</span></em>, <em class="sig-param"><span class="n">candidate_pairs_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'candidate_pairs.parquet'</span></em>, <em class="sig-param"><span class="n">data_rows_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'data_rows'</span></em>, <em class="sig-param"><span class="n">trained_model_info_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'None'</span></em>, <em class="sig-param"><span class="n">selection_model_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'basic_selection_model.pkl'</span></em>, <em class="sig-param"><span class="n">match_model_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'basic_match_model.pkl'</span></em>, <em class="sig-param"><span class="n">flipped0_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'flipped0_potential_edges.csv'</span></em>, <em class="sig-param"><span class="n">model_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'model'</span></em>, <em class="sig-param"><span class="n">model_info_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'model.yaml'</span></em>, <em class="sig-param"><span class="n">potential_edges_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'potential_edges'</span></em>, <em class="sig-param"><span class="n">cluster_assignments</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'cluster_assignments.pkl'</span></em>, <em class="sig-param"><span class="n">cluster_constraints</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span><a class="reference internal" href="#namematch.cluster.ClusterConstraints" title="namematch.cluster.ClusterConstraints">namematch.cluster.ClusterConstraints</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">an_output_file</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'all_names_with_clusterid.csv'</span></em>, <em class="sig-param"><span class="n">write_schema_params</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/namematcher.html#NameMatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.namematcher.NameMatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Name Matcher python interface to run all the steps in namematch</p>
<dl class="py method">
<dt id="namematch.namematcher.NameMatcher.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/namematcher.html#NameMatcher.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.namematcher.NameMatcher.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.predict">
<span id="namematch-predict-module"></span><h2>namematch.predict module<a class="headerlink" href="#module-namematch.predict" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.predict.Predict">
<em class="property">class </em><code class="sig-prename descclassname">namematch.predict.</code><code class="sig-name descname">Predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">data_rows_dir</span><span class="o">=</span><span class="default_value">'output_temp/data_rows'</span></em>, <em class="sig-param"><span class="n">model_info_file</span><span class="o">=</span><span class="default_value">'output_temp/model/model.yaml'</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="o">=</span><span class="default_value">'output_temp/potential_edges'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/predict.html#Predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.predict.Predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.predict.Predict.get_potential_edges">
<code class="sig-name descname">get_potential_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.predict.Predict.get_potential_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.predict.Predict.get_potential_edges_in_parallel">
<code class="sig-name descname">get_potential_edges_in_parallel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dr_file_list</span></em>, <em class="sig-param"><span class="n">match_models</span></em>, <em class="sig-param"><span class="n">model_info</span></em>, <em class="sig-param"><span class="n">output_dir</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/predict.html#Predict.get_potential_edges_in_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.predict.Predict.get_potential_edges_in_parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispatch the worker threads that will predict for unlabeled pairs in paralle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dr_file_list</strong> (<em>list</em>) – paths of output_temp’s data-rows files</p></li>
<li><p><strong>match_models</strong> (<em>dict</em>) – maps model name (e.g. basic or no-dob) to a fit match model object</p></li>
<li><p><strong>model_info</strong> (<em>dict</em>) – dict with information about how to fit the model</p></li>
<li><p><strong>output_dir</strong> – </p></li>
<li><p><strong>params</strong> (<em>Parameters object</em>) – contains parameter values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="namematch.predict.Predict.main__predict">
<code class="sig-name descname">main__predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.predict.Predict.main__predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="namematch.predict.Predict.predict">
<em class="property">classmethod </em><code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">models</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">oob</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">all_cols</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">all_models</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/predict.html#Predict.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.predict.Predict.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the trainined models to predict for pairs of records.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> (<em>dict</em>) – maps model name (e.g. basic or no-dob) to a fit match model object</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – portion of the data-rows table, with a “model_to_use” column appended</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – model type (e.g. selection or match)</p></li>
<li><p><strong>oob</strong> (<em>bool</em>) – if True, use the out-of-bag predictions</p></li>
<li><p><strong>all_cols</strong> (<em>bool</em>) – if True, keep all columns in the output df; not just the relevant ones</p></li>
<li><p><strong>all_models</strong> (<em>bool</em>) – if True, predict for each row using all models, not just the “model to use”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namematch.process_config">
<span id="namematch-process-config-module"></span><h2>namematch.process_config module<a class="headerlink" href="#module-namematch.process_config" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="namematch.process_config.main__process_config">
<code class="sig-prename descclassname">namematch.process_config.</code><code class="sig-name descname">main__process_config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config_file</span></em>, <em class="sig-param"><span class="n">nm_code_dir</span></em>, <em class="sig-param"><span class="n">logging_params</span></em>, <em class="sig-param"><span class="n">output_dir</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_config.html#main__process_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_config.main__process_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and validate the parameters and matching schema using both the
user-input config and the private config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_file</strong> (<em>str</em>) – path to user-input config file</p></li>
<li><p><strong>nm_code_dir</strong> (<em>str</em>) – path to Name Match source code</p></li>
<li><p><strong>logging_params</strong> (<em>dict</em>) – dictionary of logging parameter values</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – path to Name Match’s output_temp folder</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch.process_input_data">
<span id="namematch-process-input-data-module"></span><h2>namematch.process_input_data module<a class="headerlink" href="#module-namematch.process_input_data" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="namematch.process_input_data.ProcessInputData">
<em class="property">class </em><code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">ProcessInputData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">schema</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">'output_temp/all_names.parquet'</span></em>, <em class="sig-param"><span class="n">logger_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">input_data_batch_size</span><span class="o">=</span><span class="default_value">50000</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#ProcessInputData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.ProcessInputData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#namematch.base.NamematchBase" title="namematch.base.NamematchBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">namematch.base.NamematchBase</span></code></a></p>
<dl class="py method">
<dt id="namematch.process_input_data.ProcessInputData.main__process_input_data">
<code class="sig-name descname">main__process_input_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#namematch.process_input_data.ProcessInputData.main__process_input_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.parse_address">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">parse_address</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#parse_address"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.parse_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse an address string into distinct parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>address</strong> (<em>str</em>) – string of full address (e.g. 54 East 18th Rd.)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(address number, street name, street suffix)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_address_column">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_address_column</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_address_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_address_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Take dataframe of address data (either in “123 Main St.” format or
“123”, “Main”, “St.” format, order matters) and parse as needed to produce
three clean columns: street number, street name, and street type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – df of address input data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of clean address information for all_names file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_auto_drops">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_auto_drops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">an</span></em>, <em class="sig-param"><span class="n">existing_drop_list</span></em>, <em class="sig-param"><span class="n">drop_logic</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_auto_drops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_auto_drops" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the records in all-names that have invalid values due to combination
of multiple columns (based on logic in the private config).</p>
<dl class="simple">
<dt>ParaArgsmeters:</dt><dd><p>an (pd.DataFrame): all-names chunk being processed
existing_drop_list (list of str): records already known to be invalid
drop_logic (list of dicts): logic for what makes a record invalid</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Indices of records that are not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_check">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_check</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the validity of the values in a given all-names column (according to the data type
and config instructions) and set the series name correctly.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>s (pd.Series): series to process (will be an all-names column)
variable (Variable object): contains info on how to validate data in series</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Processed series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_data">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in part of an input file and process it according to the config in order
to create part of the all-names file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – chunk of an input data file</p></li>
<li><p><strong>variables</strong> (<em>VariableList object</em>) – contains info about the fields for matching (from config)</p></li>
<li><p><strong>data_file</strong> (<em>DataFile object</em>) – contains info about the input data set</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – dictionary of param values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>a chunk of the all-names table (one row per input record)</dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>record_id</p></td>
<td><p>unique record identifier</p></td>
</tr>
<tr class="row-even"><td><p>file_type</p></td>
<td><p>either “new” or “existing”</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;fields for matching&gt;</p></td>
<td><p>both for the matching model and for constraint checking</p></td>
</tr>
<tr class="row-even"><td><p>&lt;raw name fields&gt;</p></td>
<td><p>pre-cleaning version of first and last name</p></td>
</tr>
<tr class="row-odd"><td><p>blockstring</p></td>
<td><p>concatenated version of blocking columns (sep by ::)</p></td>
</tr>
<tr class="row-even"><td><p>drop_from_nm</p></td>
<td><p>flag, 1 if met any “to drop” criteria 0 otherwise</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_drop">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_drop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">drop_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_drop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_drop" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the records in a series that have invalid values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>pd.Series</em>) – series being processed</p></li>
<li><p><strong>drop_list</strong> (<em>list of str</em>) – invalid values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of records that are not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_geo_column">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_geo_column</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_geo_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_geo_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Take dataframe of geographic data (either in “lat,lon” format or in
“lat”, “lon” format) and ensure it has just one column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – df of address input data (columns are strings)</p></li>
<li><p><strong>variable</strong> (<em>Variable object</em>) – contains naming info for new geo column</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of clean geographic information for all_names file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="namematch.process_input_data.process_set_missing">
<code class="sig-prename descclassname">namematch.process_input_data.</code><code class="sig-name descname">process_set_missing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">set_missing_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/namematch/process_input_data.html#process_set_missing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#namematch.process_input_data.process_set_missing" title="Permalink to this definition">¶</a></dt>
<dd><p>Set values in a series to missing as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>pd.Series</em>) – strings to process</p></li>
<li><p><strong>set_missing_list</strong> (<em>list</em>) – list of strings that are disallowed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Processed series</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-namematch">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-namematch" title="Permalink to this headline">¶</a></h2>
</div>
</div>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2021, Melissa McNeill, Eddie Lin, Zubin Jelveh.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.1.
        </div>
    </div>  

</body>
</html>